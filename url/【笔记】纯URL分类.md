## 1 思路

只根据URL与描述它们的词汇、主机间特征的关系对网站分类，不考虑URL页面内容、URL的上下文（嵌入URL的页面、电子邮件等）。原因：

- 避免下载页面内容对用户更安全
- 纯URL分类更轻量级
- 专注URL特性而不是上下文，可以不依赖于特定的应用程序设置
- 可靠的获得用于训练测试的页面的恶意版本很困难（一些恶意站点为不通过客户端提供不同内容，隐藏恶意版本）

## 2 特征

### 2.1 词法特征

- 实值特征：主机名长度、URL长度、URL中点的数量

- 二进制特征
  - 主机名：用 ‘.’ 分割
  - URL路径：用 ‘/’, ‘?’, ‘.’, ‘=’, ‘-’ , ‘_’ 分割
  - 可疑单词
  - 顶级域名

​	不保留词袋的顺序；马尔科夫模型

### 2.2 主机特征

恶意网站可能托管在信誉较差的托管中心，或通过信誉不佳的注册商

- IP地址属性
  - IP地址是否在黑名单中?
  - A、MX或NS记录的ip是否在同一个as (autonomous system)或前缀中?
  - 它们属于哪些as或前缀?
- WHOIS属性
  - 注册、更新和过期的日期是什么?
  - 谁是注册主任?谁是登记人?
  - WHOIS条目被锁定了吗?
- 域名属性
  - 与主机名相关的DNS记录的生存时间(TTL)值是多少?
  - 在SpamAssassin僵尸网络插件中使用以下域名属性来检测电子邮件中恶意网站链接:
    - 主机名是否包含“client”或“server”关键字?
    - 主机名中是否包含IP地址?
    - 主机是否有PTR记录?
    - PTR记录是否依次解析主机的一个IP地址?
- 地理属性
  - IP地址属于哪个大陆/国家/城市?
  - 上行链路连接(宽带，拨号等)的速度是多少?

词法特征和主机特征应数量归一化



## 3 具体实施

- 不同特征的贡献不同，选取效率较高的
- 不同分类器的效果不同，选择效果最好的
- 域名特征：选取30个顶级域名作为良性，300多个作为恶性
- 模型在训练过程中选择了419个相关的路径令牌，其中324个是恶意的
  - ‘account’, ‘webscr’, ‘login’, ‘ebayisapi’, ‘signin’, ‘banking’, and ‘confirm’
- 3959个WHOIS信息特征(主要是域名注册商和注册人名称中的标记)中，分类器选择了633个相关特征
  - 最近的注册或更新日期被认为是恶意的，因为它们更频繁地被删除
  - 具有较新的过期日期是唯一良性的WHOIS日期功能。
- DNS a和MX记录的速度为T1是前2个良性特征
  - 在条目的a、MX或NS记录中托管地址的住宅电缆、DSL或卫星连接被认为是恶意的。
  - 这些特征反映了住宅isp中恶意站点托管在受损机器上的现象。
- 假阴性(未检测到的恶意网站)分为以下几类
  - URL中带有良性标记的网站的URL
  - 使用免费托管服务的恶意网站(如“geocities.com”或“tripod.com”)
  - 受到损害的网站
  - 重定向服务
  - 托管在有信誉的地理区域(如美国)的网站
  - 托管在美国的国际顶级域名的网站。
- 恶意网站规避检测的方法
  - 减少url词汇特征中的信息内容，如使用TinyURL之类的重定向服务会产生更少的可区分的词汇特征
  - 获得许多良性的基于主机的功能，例如隐藏在合法免费托管服务





使用更多的特征会导致更准确的分类吗?最合适的分类模型是什么?如果我们调整分类器以降低假阳性，对准确性有什么影响?我们是否可以用在不同数据源上训练过的模型有效地对来自同一个数据源的数据进行分类?我们在相关特征中看到了什么趋势?这些错误分类的例子有什么共同点?













